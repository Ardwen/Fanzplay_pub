{"ast":null,"code":"var _jsxFileName = \"/Users/owner/Desktop/FALL2021COMP523Project/fanzplay/src/components/quizboard.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport Header from './header.js';\nimport GameQuestionOver from './question_over';\nimport Button from './button';\nimport { questionURL, gameURL, qURL, resultsURL } from \"../api/api2\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Game extends Component {\n  constructor() {\n    super();\n    this.state = {\n      gid: null,\n      timer: 4,\n      isLive: false,\n      questionOver: false,\n      gameStart: false,\n      gameOver: false,\n      team1: null,\n      team2: null,\n      team1_points: 0,\n      team2_points: 0,\n      win: false,\n      team: null,\n      question: null,\n      answer: [],\n      selectedAnswer: -1,\n      correctAnswer: -1,\n      seconds: 0,\n      curQuiz: -1,\n      question_list: [],\n      score: 0,\n      uid: null,\n      tid: null\n    };\n    this.questionOver = this.question_Over.bind(this);\n    this.nextQuestion = this.nextQuestion.bind(this);\n    this.submitAnswer = this.submitAnswer.bind(this);\n    this.end_game = this.end_game.bind(this);\n  }\n\n  componentDidMount() {\n    this.setState({\n      gid: localStorage.getItem('gid'),\n      uid: localStorage.getItem('uid'),\n      tid: localStorage.getItem('tid'),\n      team: localStorage.getItem('team')\n    });\n    axios.get(questionURL).then(res => {\n      let data = res.data.documents.map(it => {\n        return it.name;\n      });\n      this.setState({\n        question_list: data\n      });\n    });\n    /*const firebaseRef = firebase.database().ref(this.props.firebaseRef);\n    const questionCountRef = ref(db, '/Questions/q2');\n     onValue(questionCountRef, (snapshot) => {\n      const data = snapshot.val();\n      console.log()\n    });*/\n  }\n\n  tick() {\n    if (this.state.seconds === this.state.timer) {\n      this.end_timer();\n    } else {\n      this.setState(prevState => ({\n        seconds: prevState.seconds + 1\n      }));\n    }\n  }\n\n  start_timer() {\n    this.interval = setInterval(() => this.tick(), 1000);\n  }\n\n  async end_timer() {\n    clearInterval(this.interval);\n    axios.get(gameURL(this.state.gid)).then(res => {\n      let data = res.data.fields;\n      let p1 = parseInt(data.totalResult1.integerValue);\n      let p2 = parseInt(data.totalResult2.integerValue);\n      let score = this.state.score;\n\n      if (this.state.selectedAnswer === this.state.correctAnswer) {\n        score = score + 1;\n\n        if (this.state.team === this.state.team1) {\n          p1 = p1 + 1;\n\n          if (this.state.curQuiz + 1 === this.state.question_list.length) {\n            this.end_game(p1, p2, score);\n          }\n\n          axios.put(\"https://us-central1-fanzplay.cloudfunctions.net/api/Games/\" + this.state.gid, {\n            totalResult1: p1\n          });\n        } else {\n          p2 = p2 + 1;\n          axios.put(\"https://us-central1-fanzplay.cloudfunctions.net/api/Games/\" + this.state.gid, {\n            totalResult2: p2\n          });\n\n          if (this.state.curQuiz + 1 === this.state.question_list.length) {\n            this.end_game(p2, p1, score);\n          }\n        }\n      }\n\n      this.setState({\n        team1_points: (p1 / (p1 + p2) * 100).toFixed(1),\n        team2_points: (p2 / (p1 + p2) * 100).toFixed(1),\n        team1: data.logos.arrayValue.values[0].stringValue,\n        team2: data.logos.arrayValue.values[1].stringValue,\n        questionOver: true,\n        seconds: 0,\n        score: score\n      });\n    });\n  }\n\n  startGame() {\n    this.nextQuestion();\n    this.setState({\n      isLive: true,\n      gameStart: true\n    });\n  }\n\n  question_Over() {\n    this.setState({\n      questionOver: true\n    });\n  }\n\n  end_game(t, o, score) {\n    if (t > o) {\n      this.setState({\n        questionOver: true,\n        gameOver: true,\n        win: true\n      });\n    } else {\n      this.setState({\n        questionOver: true,\n        gameOver: true,\n        win: false\n      });\n    }\n\n    axios.post(resultsURL, {\n      gid: this.state.gid,\n      uid: this.state.uid,\n      score: score,\n      tid: this.state.tid\n    }).then(function (response) {\n      console.log(response);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  nextQuestion() {\n    let a = this.state.curQuiz + 1;\n\n    if (a == this.state.question_list.length) {\n      this.end_game();\n    } else {\n      console.log(qURL(this.state.question_list[a]));\n      axios.get(qURL(this.state.question_list[a])).then(res => {\n        let data = res.data.fields;\n        this.setState({\n          question: data.question.stringValue,\n          answer: data.answers.arrayValue.values,\n          correctAnswer: parseInt(data.correctIdx.integerValue),\n          questionOver: false,\n          isLive: true,\n          curQuiz: a\n        });\n        this.start_timer();\n      });\n    }\n  }\n\n  submitAnswer(id) {\n    //axios.put()\n    this.setState({\n      selectedAnswer: id\n    });\n  }\n\n  render() {\n    console.log(this.state);\n    let {\n      timer,\n      isLive,\n      questionOver,\n      gameStart,\n      gameOver,\n      team1,\n      team2,\n      team1_points,\n      team2_points,\n      win,\n      team,\n      question,\n      answer,\n      selectedAnswer,\n      correctAnswer,\n      seconds\n    } = this.state;\n    let timeLeft = timer - seconds;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"component-container\",\n      children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 13\n      }, this), !isLive && !questionOver && !gameOver ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"You are playing for\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 31\n          }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n            src: team,\n            style: {\n              width: \"60%\"\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 31\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"We will let you know when it's time to play\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button\",\n          onClick: () => this.nextQuestion(),\n          children: \"start\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 25\n      }, this) : //questionBoard\n      isLive && !questionOver && !gameOver ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"questions-container\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"center\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: timeLeft\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"player-name\",\n            children: question\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"center\",\n            children: answer.map((item, i) => {\n              return /*#__PURE__*/_jsxDEV(Button, {\n                onClick: () => this.submitAnswer(i),\n                id: i,\n                children: item.stringValue\n              }, i, false, {\n                fileName: _jsxFileName,\n                lineNumber: 204,\n                columnNumber: 41\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 29\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 25\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(GameQuestionOver, {\n          team1: team1,\n          team2: team2,\n          team1_p: team1_points,\n          team2_p: team2_points,\n          lastQuestion: gameOver,\n          correct: selectedAnswer === correctAnswer,\n          gameOver: gameOver,\n          win: win\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 29\n        }, this), !gameOver ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"center\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"button\",\n            onClick: () => this.nextQuestion(),\n            children: \"nextQuestion\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 33\n        }, this) : \"\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 29\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default Game;","map":{"version":3,"sources":["/Users/owner/Desktop/FALL2021COMP523Project/fanzplay/src/components/quizboard.js"],"names":["React","Component","axios","Header","GameQuestionOver","Button","questionURL","gameURL","qURL","resultsURL","Game","constructor","state","gid","timer","isLive","questionOver","gameStart","gameOver","team1","team2","team1_points","team2_points","win","team","question","answer","selectedAnswer","correctAnswer","seconds","curQuiz","question_list","score","uid","tid","question_Over","bind","nextQuestion","submitAnswer","end_game","componentDidMount","setState","localStorage","getItem","get","then","res","data","documents","map","it","name","tick","end_timer","prevState","start_timer","interval","setInterval","clearInterval","fields","p1","parseInt","totalResult1","integerValue","p2","totalResult2","length","put","toFixed","logos","arrayValue","values","stringValue","startGame","t","o","post","response","console","log","catch","error","a","answers","correctIdx","id","render","timeLeft","width","item","i"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport Header from './header.js';\nimport GameQuestionOver from './question_over';\nimport Button from './button';\nimport {questionURL,gameURL,qURL,resultsURL} from \"../api/api2\";\n\nclass Game extends Component {\n    constructor() {\n        super();\n        this.state = {\n            gid:null,\n            timer: 4,\n            isLive: false,\n            questionOver: false,\n            gameStart:false,\n            gameOver: false,\n            team1:null,\n            team2:null,\n            team1_points:0,\n            team2_points:0,\n            win:false,\n            team: null,\n            question:null,\n            answer:[],\n            selectedAnswer:-1,\n            correctAnswer:-1,\n            seconds:0,\n            curQuiz: -1,\n            question_list:[],\n            score:0,\n            uid:null,\n            tid:null\n        }\n        this.questionOver = this.question_Over.bind(this);\n        this.nextQuestion = this.nextQuestion.bind(this);\n        this.submitAnswer = this.submitAnswer.bind(this);\n        this.end_game = this.end_game.bind(this);\n    }\n    componentDidMount() {\n        this.setState({\n          gid:localStorage.getItem('gid'),\n          uid:localStorage.getItem('uid'),\n          tid:localStorage.getItem('tid'),\n          team:localStorage.getItem('team')});\n          axios.get(questionURL).then(res => {\n                let data = res.data.documents.map((it)=>{return(it.name)});\n                this.setState({\n                   question_list:data\n                 });\n            })\n          /*const firebaseRef = firebase.database().ref(this.props.firebaseRef);\n          const questionCountRef = ref(db, '/Questions/q2');\n\n          onValue(questionCountRef, (snapshot) => {\n            const data = snapshot.val();\n            console.log()\n          });*/\n\n    }\n\n    tick() {\n      if (this.state.seconds === this.state.timer) {\n        this.end_timer()\n      } else {\n        this.setState((prevState) => ({\n          seconds: prevState.seconds + 1\n        }));\n      }\n    }\n\n    start_timer() {\n      this.interval = setInterval(() => this.tick(), 1000);\n    }\n\n      async end_timer() {\n      clearInterval(this.interval);\n      axios.get(gameURL(this.state.gid)).then(res => {\n            let data = res.data.fields\n            let p1=parseInt(data.totalResult1.integerValue)\n            let p2=parseInt(data.totalResult2.integerValue)\n            let score = this.state.score\n            if(this.state.selectedAnswer===this.state.correctAnswer){\n              score=score+1\n              if (this.state.team===this.state.team1){\n                p1=p1+1\n                if (this.state.curQuiz+1===this.state.question_list.length){this.end_game(p1,p2,score)}\n                axios.put(\"https://us-central1-fanzplay.cloudfunctions.net/api/Games/\"+this.state.gid, {totalResult1:p1});\n              } else {\n                p2=p2+1\n                axios.put(\"https://us-central1-fanzplay.cloudfunctions.net/api/Games/\"+this.state.gid, {totalResult2:p2});\n                if (this.state.curQuiz+1===this.state.question_list.length){this.end_game(p2,p1,score)}\n              }\n            }\n            this.setState({\n               team1_points:(p1/(p1+p2)*100).toFixed(1),\n               team2_points:(p2/(p1+p2)*100).toFixed(1),\n               team1:data.logos.arrayValue.values[0].stringValue,\n               team2:data.logos.arrayValue.values[1].stringValue,\n               questionOver:true,\n               seconds: 0,\n               score: score\n             });\n\n        })\n    }\n\n    startGame() {\n            this.nextQuestion()\n            this.setState({\n                isLive: true,\n                gameStart:true\n            })\n    }\n\n    question_Over() {\n        this.setState({\n            questionOver: true\n        })\n    }\n\n    end_game(t,o,score) {\n      if (t>o){\n      this.setState({\n          questionOver: true,\n          gameOver: true,\n          win: true\n      })}else{\n        this.setState({\n            questionOver: true,\n            gameOver: true,\n            win: false\n        })\n      }\n      axios.post(resultsURL, {\n          gid: this.state.gid,\n          uid: this.state.uid,\n          score:score,\n          tid: this.state.tid\n      })\n      .then(function (response) {\n        console.log(response);\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n    }\n\n\n    nextQuestion() {\n      let a = this.state.curQuiz+1\n      if (a==this.state.question_list.length){this.end_game()}else{\n      console.log(qURL(this.state.question_list[a]))\n      axios.get(qURL(this.state.question_list[a])).then(res => {\n        let data=res.data.fields;\n        this.setState({\n          question: data.question.stringValue,\n          answer:data.answers.arrayValue.values,\n          correctAnswer: parseInt(data.correctIdx.integerValue),\n          questionOver:false,\n          isLive:true,\n          curQuiz: a});\n          this.start_timer();\n        });}\n    }\n\n\n    submitAnswer(id) {\n      //axios.put()\n      this.setState({\n          selectedAnswer: id\n      })\n    }\n\n    render() {\n        console.log(this.state)\n        let {timer,isLive, questionOver,gameStart,gameOver,team1,team2,team1_points,team2_points, win,team,question,answer,selectedAnswer,correctAnswer,seconds} = this.state;\n        let timeLeft = timer - seconds;\n        return (\n            <div className='component-container' >\n            <Header />\n                {\n                    !isLive && !questionOver && !gameOver ?\n                        <div className='center' >\n                        <div>\n                              <h3>You are playing for</h3>\n                              <img src={team} style={{width: \"60%\"}}/>\n                        </div>\n                            <h2>We will let you know when it's time to play</h2>\n                            <button className=\"button\" onClick={()=>this.nextQuestion()}>start</button>\n                        </div>\n                        :\n                        //questionBoard\n                        isLive && !questionOver && !gameOver ?\n                        <div className='questions-container' >\n                            <div className='center' >\n                            <h2>{timeLeft}</h2>\n                            <br/>\n                            <br/>\n                            <p className='player-name'>{question}</p>\n                            <div className='center' >\n                            {answer.map((item, i) => {\n                                return (\n                                        <Button\n                                        key={i}\n                                        onClick={()=>this.submitAnswer(i)}\n                                        id={i}\n                                        >\n                                        {item.stringValue}\n                                        </Button>\n                                    );})}\n                              </div>\n                            </div>\n                        </div>\n                            :\n                            <div>\n                            <GameQuestionOver\n                                team1={team1}\n                                team2={team2}\n                                team1_p={team1_points}\n                                team2_p={team2_points}\n                                lastQuestion={gameOver}\n                                correct={selectedAnswer===correctAnswer}\n                                gameOver={gameOver}\n                                win={win}  />\n                                {!gameOver?\n                                <div className=\"center\">\n                                <button className=\"button\" onClick={()=>this.nextQuestion()}>nextQuestion</button>\n                                </div>:\"\"}\n                          </div>\n                }\n            </div>\n        )\n    }\n}\nexport default Game;\n"]},"metadata":{},"sourceType":"module"}